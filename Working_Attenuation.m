%clear all
% radar frequency (Hz);
freq = linspace(5e9, 50e9, 201);
c = 3e8;
% radar wavelength (mm);
lambda = c./freq;
% temperature of water in celsius
T_w = [-10 0 10 20];

n_w =  [7.669252353	8.318656521	8.865506538	8.707521925
7.617659222	8.262694674	8.825701388	8.668426108
7.566413173	8.207109296	8.786074958	8.629505827
7.515511869	8.151897857	8.746626446	8.590760293
7.464952992	8.097057839	8.707355054	8.552188723
7.414734238	8.042586746	8.668259986	8.513790335
7.36485332	7.988482094	8.629340451	8.475564352
7.315307963	7.934741419	8.59059566	8.437509998
7.266095912	7.881362271	8.552024829	8.399626505
7.217214924	7.82834222	8.513627177	8.361913105
7.168662771	7.775678849	8.475401926	8.324369033
7.120437241	7.723369758	8.437348302	8.286993531
7.072536138	7.671412565	8.399465535	8.24978584
7.024957279	7.619804902	8.361752857	8.212745207
6.977698495	7.568544418	8.324209505	8.175870883
6.930757634	7.517628777	8.286834719	8.139162121
6.884132556	7.467055659	8.249627741	8.102618177
6.837821138	7.41682276	8.212587818	8.066238311
6.79182127	7.366927791	8.175714201	8.030021787
6.746130855	7.317368479	8.139006142	7.993967871
6.700747812	7.268142567	8.102462898	7.958075834
6.655670072	7.21924781	8.06608373	7.922344947
6.610895583	7.170681981	8.0298679	7.886774489
6.566422304	7.122442868	7.993814675	7.851363737
6.522248209	7.074528272	7.957923325	7.816111976
6.478371285	7.026936011	7.922193123	7.781018492
6.434789533	6.979663916	7.886623346	7.746082574
6.391500967	6.932709833	7.851213274	7.711303514
6.348503614	6.886071622	7.815962188	7.676680608
6.305795517	6.83974716	7.780869377	7.642213155
6.263374728	6.793734334	7.745934128	7.607900457
6.221239316	6.74803105	7.711155734	7.57374182
6.17938736	6.702635223	7.676533492	7.539736551
6.137816953	6.657544787	7.642066699	7.505883962
6.096526202	6.612757686	7.607754659	7.472183367
6.055513224	6.56827188	7.573596676	7.438634085
6.014776152	6.524085343	7.539592059	7.405235434
5.97431313	6.480196059	7.505740119	7.371986741
5.934122313	6.436602031	7.47204017	7.33888733
5.89420187	6.393301272	7.43849153	7.305936532
5.854549983	6.350291809	7.40509352	7.273133679
5.815164845	6.307571682	7.371845464	7.240478108
5.776044662	6.265138945	7.338746687	7.207969156
5.73718765	6.222991664	7.305796521	7.175606166
5.69859204	6.181127919	7.272994297	7.143388483
5.660256073	6.139545803	7.240339351	7.111315453
5.622178003	6.098243421	7.207831023	7.079386428
5.584356094	6.057218892	7.175468653	7.04760076
5.546788623	6.016470345	7.143251587	7.015957807
5.509473879	5.975995925	7.111179172	6.984456927
5.472410161	5.935793788	7.079250758	6.953097482
5.435595781	5.895862101	7.0474657	6.921878838
5.399029061	5.856199045	7.015823353	6.890800363
5.362708335	5.816802813	6.984323077	6.859861426
5.326631949	5.777671611	6.952964233	6.829061401
5.290798258	5.738803654	6.921746187	6.798399666
5.25520563	5.700197173	6.890668307	6.767875598
5.219852443	5.661850408	6.859729963	6.73748858
5.184737087	5.623761612	6.828930529	6.707237996
5.149857961	5.58592905	6.798269381	6.677123234
5.115213476	5.548350997	6.767745898	6.647143684
5.080802054	5.511025742	6.737359462	6.617298739
5.046622128	5.473951585	6.707109458	6.587587794
5.012672138	5.437126835	6.676995274	6.558010249
4.97895054	5.400549815	6.647016298	6.528565503
4.945455796	5.364218859	6.617171925	6.499252961
4.91218638	5.328132311	6.58746155	6.470072029
4.879140776	5.292288526	6.557884571	6.441022116
4.846317479	5.256685873	6.528440389	6.412102634
4.813714993	5.221322728	6.499128409	6.383312998
4.781331833	5.186197481	6.469948036	6.354652623
4.749166523	5.151308531	6.44089868	6.326120931
4.717217598	5.116654288	6.411979753	6.297717343
4.685483602	5.082233173	6.383190668	6.269441284
4.653963089	5.048043619	6.354530843	6.241292181
4.622654623	5.014084067	6.325999697	6.213269464
4.591556778	4.98035297	6.297596653	6.185372567
4.560668136	4.946848791	6.269321136	6.157600923
4.52998729	4.913570004	6.241172573	6.129953972
4.499512843	4.880515092	6.213150393	6.102431151
4.469243406	4.84768255	6.18525403	6.075031906
4.439177599	4.815070881	6.157482919	6.04775568
4.409314053	4.782678599	6.129836497	6.020601921
4.379651407	4.75050423	6.102314204	5.99357008
4.35018831	4.718546305	6.074915484	5.966659608
4.320923419	4.686803371	6.04763978	5.939869962
4.291855401	4.655273979	6.020486542	5.913200598
4.262982931	4.623956695	5.993455219	5.886650977
4.234304694	4.59285009	5.966545263	5.860220561
4.205819384	4.561952748	5.93975613	5.833908814
4.177525702	4.53126326	5.913087277	5.807715204
4.149422359	4.500780229	5.886538165	5.781639201
4.121508074	4.470502266	5.860108255	5.755680276
4.093781577	4.44042799	5.833797013	5.729837903
4.066241603	4.410556033	5.807603905	5.70411156
4.038886899	4.380885032	5.781528401	5.678500726
4.011716216	4.351413636	5.755569974	5.653004881
3.984728318	4.322140501	5.729728097	5.62762351
3.957921975	4.293064296	5.704002247	5.602356099
3.931295966	4.264183693	5.678391903	5.577202135
3.904849077	4.235497379	5.652896547	5.55216111
3.878580103	4.207004045	5.627515662	5.527232517
3.852487848	4.178702393	5.602248735	5.50241585
3.826571122	4.150591134	5.577095254	5.477710607
3.800828745	4.122668987	5.552054709	5.453116288
3.775259545	4.09493468	5.527126593	5.428632395
3.749862355	4.067386949	5.502310401	5.404258431
3.724636018	4.040024539	5.477605632	5.379993905
3.699579386	4.012846204	5.453011784	5.355838323
3.674691317	3.985850704	5.42852836	5.331791197
3.649970677	3.95903681	5.404154864	5.30785204
3.625416339	3.932403301	5.379890802	5.284020367
3.601027185	3.905948963	5.355735683	5.260295696
3.576802103	3.87967259	5.331689018	5.236677546
3.55273999	3.853572985	5.30775032	5.213165439
3.528839749	3.827648959	5.283919104	5.189758899
3.505100291	3.801899332	5.260194888	5.166457452
3.481520536	3.776322929	5.236577191	5.143260625
3.458099407	3.750918585	5.213065534	5.12016795
3.434835839	3.725685143	5.189659442	5.097178958
3.411728771	3.700621454	5.166358442	5.074293184
3.388777151	3.675726374	5.14316206	5.051510165
3.365979932	3.650998771	5.120069827	5.028829439
3.343336077	3.626437517	5.097081276	5.006250547
3.320844552	3.602041493	5.07419594	4.983773032
3.298504335	3.577809587	5.051413358	4.961396439
3.276314406	3.553740696	5.028733067	4.939120314
3.254273754	3.529833723	5.006154608	4.916944206
3.232381377	3.506087579	4.983677523	4.894867667
3.210636274	3.482501182	4.961301359	4.872890248
3.189037458	3.459073456	4.93902566	4.851011506
3.167583942	3.435803335	4.916849978	4.829230997
3.14627475	3.412689759	4.894773861	4.807548281
3.12510891	3.389731674	4.872796864	4.785962917
3.104085459	3.366928034	4.850918541	4.764474469
3.083203438	3.3442778	4.82913845	4.743082502
3.062461897	3.321779941	4.807456149	4.721786582
3.041859889	3.29943343	4.785871199	4.700586279
3.021396476	3.277237251	4.764383163	4.679481163
3.001070727	3.255190392	4.742991605	4.658470807
2.980881714	3.233291847	4.721696094	4.637554784
2.960828518	3.21154062	4.700496197	4.616732673
2.940910225	3.18993572	4.679391485	4.59600405
2.921125928	3.168476161	4.658381532	4.575368497
2.901474726	3.147160967	4.63746591	4.554825595
2.881955722	3.125989165	4.616644198	4.534374928
2.862568028	3.104959792	4.595915972	4.514016083
2.84331076	3.08407189	4.575280814	4.493748646
2.824183041	3.063324506	4.554738306	4.473572208
2.805184	3.042716695	4.534288031	4.45348636
2.78631277	3.022247518	4.513929576	4.433490696
2.767568492	3.001916044	4.493662528	4.413584809
2.748950311	2.981721344	4.473486477	4.393768298
2.730457381	2.9616625	4.453401014	4.374040761
2.712088857	2.941738597	4.433405732	4.354401799
2.693843903	2.921948727	4.413500227	4.334851013
2.675721688	2.902291989	4.393684096	4.315388008
2.657721386	2.882767488	4.373956937	4.29601239
2.639842177	2.863374333	4.354318351	4.276723766
2.622083246	2.844111641	4.33476794	4.257521746
2.604443784	2.824978534	4.315305308	4.238405941
2.586922988	2.805974141	4.295930061	4.219375964
2.569520059	2.787097595	4.276641807	4.200431429
2.552234204	2.768348038	4.257440155	4.181571953
2.535064635	2.749724613	4.238324716	4.162797154
2.518010571	2.731226473	4.219295103	4.144106652
2.501071234	2.712852776	4.200350932	4.125500069
2.484245853	2.694602683	4.181491817	4.106977026
2.467533661	2.676475363	4.162717378	4.088537151
2.450933896	2.658469991	4.144027235	4.070180068
2.434445802	2.640585746	4.125421007	4.051905406
2.418068628	2.622821813	4.10689832	4.033712796
2.401801627	2.605177383	4.088458798	4.015601869
2.38564406	2.587651651	4.070102067	3.997572257
2.369595188	2.57024382	4.051827756	3.979623597
2.353654282	2.552953096	4.033635494	3.961755524
2.337820614	2.535778691	4.015524914	3.943967677
2.322093464	2.518719824	3.997495648	3.926259695
2.306472114	2.501775716	3.979547331	3.90863122
2.290955854	2.484945595	3.961679601	3.891081895
2.275543975	2.468228695	3.943892095	3.873611365
2.260235777	2.451624255	3.926184452	3.856219276
2.245030561	2.435131517	3.908556315	3.838905275
2.229927634	2.41874973	3.891007327	3.821669011
2.214926309	2.402478147	3.873537131	3.804510137
2.200025902	2.386316028	3.856145375	3.787428305
2.185225734	2.370262636	3.838831706	3.770423168
2.17052513	2.35431724	3.821595773	3.753494382
2.155923422	2.338479112	3.804437228	3.736641604
2.141419943	2.322747532	3.787355722	3.719864494
2.127014033	2.307121782	3.770350911	3.703162711
2.112705036	2.291601151	3.75342245	3.686535917
2.098492299	2.276184932	3.736569995	3.669983775
2.084375175	2.260872421	3.719793206	3.653505951
2.07035302	2.245662922	3.703091743	3.637102111
2.056425197	2.230555742	3.686465268	3.620771922
2.042591069	2.215550191	3.669913444	3.604515054
2.028850008	2.200645587	3.653435936	3.588331177
2.015201386	2.18584125	3.637032409	3.572219964
2.001644582	2.171136506	3.620702533	3.556181089
1.988178979	2.156530685	3.604445977	3.540214226
];

k_w =  [2.43279882	3.080888875	1.764352016	1.240048192
2.444533721	3.06768381	1.798002925	1.285618873
2.455773793	3.055035566	1.830234865	1.329267961
2.466559084	3.04289908	1.861162678	1.371150975
2.476924969	3.031234544	1.890887805	1.41140529
2.486902849	3.020006622	1.919500292	1.450152848
2.496520725	3.009183805	1.947080437	1.487502389
2.505803675	2.998737875	1.973700147	1.523551292
2.514774241	2.988643465	1.999424069	1.558387101
2.523452765	2.978877684	2.024310534	1.592088811
2.531857664	2.969419808	2.048412355	1.624727942
2.540005666	2.960251013	2.071777502	1.656369454
2.547912012	2.95135415	2.094449674	1.687072527
2.555590623	2.942713553	2.116468796	1.716891229
2.563054252	2.934314871	2.137871438	1.745875081
2.570314609	2.926144926	2.158691181	1.774069562
2.577382476	2.918191588	2.178958937	1.80151653
2.584267794	2.910443668	2.198703219	1.828254601
2.590979757	2.902890822	2.21795039	1.854319475
2.59752688	2.895523466	2.236724867	1.879744218
2.603917066	2.888332709	2.255049312	1.90455952
2.610157663	2.881310282	2.272944798	1.928793917
2.616255514	2.874448484	2.290430948	1.952473983
2.622217005	2.86774013	2.30752607	1.975624513
2.6280481	2.861178507	2.324247271	1.998268672
2.633754382	2.854757334	2.340610559	2.020428139
2.639341082	2.848470725	2.356630936	2.042123228
2.64481311	2.842313154	2.372322479	2.063373005
2.650175079	2.836279431	2.387698416	2.084195383
2.655431328	2.830364672	2.402771194	2.104607216
2.660585946	2.824564277	2.417552535	2.124624381
2.665642789	2.818873906	2.432053496	2.144261851
2.670605497	2.813289463	2.446284517	2.163533762
2.675477511	2.807807077	2.460255465	2.182453476
2.680262086	2.802423084	2.473975673	2.201033636
2.684962305	2.797134015	2.487453985	2.219286214
2.689581093	2.79193658	2.500698782	2.237222563
2.694121221	2.786827658	2.513718018	2.254853453
2.698585326	2.781804285	2.526519248	2.272189113
2.70297591	2.776863642	2.539109651	2.28923927
2.707295356	2.77200305	2.551496061	2.306013174
2.711545933	2.767219955	2.563684982	2.322519636
2.715729803	2.762511925	2.575682612	2.338767048
2.719849027	2.757876639	2.587494864	2.354763418
2.723905572	2.753311885	2.59912738	2.370516385
2.727901317	2.748815548	2.610585546	2.386033245
2.731838058	2.744385607	2.621874512	2.401320971
2.735717512	2.74002013	2.632999203	2.416386233
2.739541322	2.735717267	2.643964332	2.431235412
2.743311063	2.731475248	2.654774409	2.445874619
2.747028242	2.727292376	2.665433761	2.460309709
2.750694304	2.723167025	2.675946532	2.474546297
2.754310637	2.719097633	2.686316698	2.488589768
2.757878571	2.715082703	2.696548078	2.502445291
2.761399385	2.711120797	2.706644336	2.51611783
2.764874308	2.707210531	2.716608996	2.529612156
2.768304519	2.703350578	2.726445443	2.542932854
2.771691156	2.699539659	2.736156936	2.556084337
2.775035312	2.695776543	2.745746608	2.569070848
2.778338038	2.692060047	2.75521748	2.581896477
2.781600349	2.688389029	2.764572457	2.59456516
2.784823223	2.68476239	2.773814343	2.607080692
2.7880076	2.681179069	2.782945838	2.619446731
2.791154391	2.677638045	2.791969549	2.631666808
2.794264472	2.674138329	2.800887991	2.643744326
2.797338689	2.67067897	2.809703592	2.655682575
2.80037786	2.667259047	2.818418696	2.66748473
2.803382776	2.663877671	2.827035568	2.679153857
2.8063542	2.660533983	2.8355564	2.690692924
2.809292871	2.657227152	2.843983307	2.702104797
2.812199501	2.653956375	2.852318338	2.71339225
2.815074784	2.650720873	2.860563475	2.724557967
2.817919387	2.647519894	2.868720636	2.735604544
2.820733959	2.64435271	2.876791678	2.746534499
2.823519126	2.641218613	2.884778402	2.757350268
2.826275498	2.638116919	2.892682551	2.768054212
2.829003663	2.635046966	2.900505814	2.778648619
2.831704192	2.632008111	2.908249831	2.789135709
2.834377641	2.628999729	2.91591619	2.799517635
2.837024546	2.626021216	2.923506435	2.809796484
2.83964543	2.623071984	2.93102206	2.819974283
2.842240799	2.620151464	2.93846452	2.830052999
2.844811146	2.6172591	2.945835226	2.840034544
2.847356948	2.614394357	2.953135546	2.849920773
2.849878669	2.611556711	2.960366814	2.85971349
2.852376761	2.608745655	2.967530323	2.869414445
2.854851663	2.605960694	2.974627331	2.879025345
2.857303801	2.603201349	2.981659062	2.888547844
2.85973359	2.600467153	2.988626705	2.897983555
2.862141434	2.597757651	2.995531418	2.907334045
2.864527725	2.595072402	3.002374328	2.91660084
2.866892847	2.592410975	3.009156532	2.925785425
2.869237171	2.589772951	3.015879096	2.934889245
2.871561059	2.587157923	3.02254306	2.943913709
2.873864866	2.584565492	3.029149438	2.952860188
2.876148936	2.581995271	3.035699217	2.961730018
2.878413602	2.579446884	3.042193357	2.970524503
2.880659193	2.576919962	3.048632796	2.97924491
2.882886028	2.574414147	3.055018448	2.987892478
2.885094416	2.571929089	3.061351204	2.996468412
2.887284661	2.569464448	3.067631933	3.004973892
2.889457059	2.567019889	3.073861483	3.013410063
2.891611898	2.564595089	3.080040681	3.021778048
2.893749459	2.562189731	3.086170336	3.030078939
2.895870018	2.559803505	3.092251234	3.038313803
2.897973843	2.55743611	3.098284145	3.046483683
2.900061196	2.555087251	3.104269822	3.054589597
2.902132333	2.552756639	3.110208997	3.062632537
2.904187504	2.550443994	3.116102388	3.070613476
2.906226953	2.54814904	3.121950696	3.078533362
2.908250919	2.545871509	3.127754604	3.086393121
2.910259635	2.543611139	3.133514782	3.094193661
2.912253329	2.541367672	3.139231884	3.101935865
2.914232225	2.539140857	3.144906549	3.109620602
2.91619654	2.53693045	3.150539403	3.117248716
2.918146488	2.53473621	3.156131057	3.124821038
2.920082277	2.532557903	3.16168211	3.132338376
2.922004111	2.530395299	3.167193147	3.139801524
2.923912191	2.528248172	3.172664741	3.147211258
2.925806711	2.526116304	3.178097452	3.154568336
2.927687864	2.523999478	3.18349183	3.161873501
2.929555836	2.521897484	3.188848411	3.169127482
2.93141081	2.519810116	3.194167721	3.17633099
2.933252967	2.517737171	3.199450276	3.183484723
2.935082483	2.515678452	3.204696579	3.190589364
2.936899529	2.513633764	3.209907126	3.197645582
2.938704274	2.511602917	3.215082399	3.204654033
2.940496885	2.509585726	3.220222874	3.211615359
2.942277522	2.507582008	3.225329016	3.21853019
2.944046345	2.505591584	3.230401279	3.225399142
2.94580351	2.50361428	3.235440111	3.232222821
2.947549169	2.501649922	3.240445949	3.23900182
2.949283473	2.499698343	3.245419223	3.245736719
2.951006567	2.497759377	3.250360353	3.252428089
2.952718595	2.495832863	3.255269753	3.259076488
2.9544197	2.493918642	3.260147827	3.265682466
2.956110019	2.492016558	3.264994972	3.27224656
2.957789689	2.490126457	3.269811579	3.278769298
2.959458842	2.48824819	3.27459803	3.285251197
2.96111761	2.486381609	3.279354699	3.291692766
2.962766121	2.484526571	3.284081956	3.298094504
2.964404501	2.482682932	3.288780161	3.304456901
2.966032874	2.480850555	3.29344967	3.310780436
2.967651361	2.479029301	3.298090831	3.317065582
2.969260082	2.477219038	3.302703986	3.323312801
2.970859154	2.475419632	3.307289471	3.32952255
2.972448691	2.473630955	3.311847616	3.335695274
2.974028808	2.471852879	3.316378746	3.341831414
2.975599614	2.47008528	3.320883178	3.347931399
2.97716122	2.468328035	3.325361225	3.353995653
2.978713732	2.466581022	3.329813195	3.360024592
2.980257255	2.464844124	3.33423939	3.366018627
2.981791893	2.463117225	3.338640105	3.371978157
2.983317748	2.461400209	3.343015634	3.377903579
2.984834919	2.459692964	3.347366262	3.38379528
2.986343505	2.457995381	3.351692272	3.389653642
2.987843603	2.456307349	3.35599394	3.39547904
2.989335307	2.454628762	3.360271539	3.401271843
2.990818711	2.452959515	3.364525337	3.407032415
2.992293907	2.451299504	3.368755596	3.41276111
2.993760985	2.449648629	3.372962577	3.418458282
2.995220034	2.448006788	3.377146534	3.424124273
2.996671141	2.446373884	3.381307718	3.429759425
2.998114393	2.44474982	3.385446375	3.43536407
2.999549874	2.443134501	3.389562747	3.440938538
3.000977666	2.441527832	3.393657074	3.446483151
3.002397853	2.439929723	3.39772959	3.451998227
3.003810515	2.438340081	3.401780527	3.457484081
3.00521573	2.436758818	3.405810112	3.462941019
3.006613578	2.435185846	3.409818568	3.468369344
3.008004135	2.433621079	3.413806117	3.473769357
3.009387476	2.432064431	3.417772975	3.479141349
3.010763676	2.430515818	3.421719356	3.484485611
3.012132809	2.428975159	3.425645471	3.489802427
3.013494946	2.427442371	3.429551525	3.495092078
3.01485016	2.425917375	3.433437724	3.50035484
3.016198519	2.424400091	3.437304268	3.505590985
3.017540093	2.422890443	3.441151354	3.510800781
3.01887495	2.421388354	3.444979179	3.515984491
3.020203156	2.419893748	3.448787933	3.521142376
3.021524778	2.418406551	3.452577806	3.526274692
3.022839881	2.416926691	3.456348983	3.531381691
3.024148528	2.415454094	3.46010165	3.536463621
3.025450783	2.413988691	3.463835986	3.541520727
3.026746708	2.412530411	3.467552169	3.546553251
3.028036364	2.411079186	3.471250376	3.551561431
3.029319811	2.409634946	3.474930778	3.5565455
3.030597109	2.408197627	3.478593548	3.561505691
3.031868317	2.40676716	3.482238853	3.56644223
3.033133492	2.405343482	3.485866859	3.571355342
3.034392691	2.403926529	3.489477729	3.576245249
3.035645971	2.402516236	3.493071624	3.581112168
3.036893387	2.401112543	3.496648704	3.585956315
3.038134994	2.399715386	3.500209124	3.590777902
3.039370844	2.398324706	3.50375304	3.595577138
3.040600993	2.396940443	3.507280603	3.60035423
3.041825491	2.395562538	3.510791964	3.60510938
3.043044391	2.394190933	3.514287272	3.609842789
3.044257743	2.392825571	3.517766671	3.614554656
3.045465598	2.391466394	3.521230306	3.619245175
3.046668005	2.390113347	3.52467832	3.623914539
];

m_w = n_w + (i*k_w);
Km = ((m_w.^2)+1)/((m_w.^2)+2);
Km2_w = abs(Km^2);
ImKm_w = imag(-1 * Km);

% Range of normalize diameters (pi D / lambda) to plot
D_n = linspace(0.01, 10, 201);
deltaD = 10;

% Defining variables
nt = length(T_w); % nt = the number of elements in the temperature of the water
nl = length(lambda); % nl = the number of elements in lambda, the radar wavelengths
nd = length(D_n); % nd = the number of elements in the range of normalized diameters
 
% set up arrays filling them with zeros
sig_a = zeros(nl, nd); 
sig_s = zeros(nl, nd);
sig_an = zeros(nl, nd);
sig_sn = zeros(nl, nd);
sig_ed = zeros(nl, nd);
att = zeros(nl, nd);
Nd = zeros(nl, nd);
trans = zeros(nl, nd);

fprintf(1, 'Possible temperature values\n')
fprintf(1, '1: -10C\n')
fprintf(1, '2:  0C\n')
fprintf(1, '3: 10C\n')
fprintf(1, '4: 20C\n')
ti = input('Enter the temperature index (1 - 4): ');
switch ti
 case 1
  ptit = 'Temperature = -10^{\circ}C';
 case 2
  ptit = 'Temperature = 0^{\circ}C';
 case 3
  ptit = 'Temperature = 10^{\circ}C';
 case 4
  ptit = 'Temperature = 20^{\circ}C';
 otherwise
  fprintf('*** Invalid Selection ... exiting!\n');
  return
end

R = input('Enter the rainfall rate in mm per hour: ');

        for lambi = 1: nl % start of loop to calculate for a given lambi (element of lambda)
            D = lambda(lambi)*reshape(D_n, 1, nd)/pi;
            sig_a(lambi, :) = pi^2*D.^3/lambda(lambi)*ImKm_w(ti, lambi); % calculates absorption cross section
            sig_s(lambi, :) = 2*pi^5*D.^6/3/lambda(lambi)^4*Km2_w(ti, lambi); % calculates scattering cross section
            sig_an(lambi, :) = 4*sig_a(lambi, :)./(pi*D.^2); % calculates normalized absorption cross section
            sig_sn(lambi, :) = 4*sig_s(lambi, :)./(pi*D.^2); % calculates normalized scattering cross section
            Nd (lambi, :) = (0.08^-1)*exp(-41*R^(-0.21).*D);
        end
        
sig_ed = sig_an + sig_sn; % calculates normalized extinction cross section
norm = 4.34e3 * 3e8;
att = norm * Nd .* sig_ed .* deltaD; % calculates attenuation
trans = 1 - att;



fntsz = 14;
figure(1)
clf

mesh (D_n, freq, att)
set(gca, 'fontsize', fntsz)
xlabel('Normalized Drop Diameter (\pi D / \lambda)')
ylabel('Frequency (Hz)')
zlabel('Attenuation (Db / Km)')
title(ptit)
  
  fntsz = 14;
figure(2)
clf
mesh (D_n, freq, trans)
set(gca, 'fontsize', fntsz)
xlabel('Normalized Drop Diameter (\pi D / \lambda)')
ylabel ('Frequency (Hz)')
zlabel('Transmission (dB/Km)')
title(ptit)